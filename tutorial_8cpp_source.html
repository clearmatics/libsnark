<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Clearmatics Libsnark: /home/runner/work/libsnark/libsnark/libsnark/gadgetlib2/examples/tutorial.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Clearmatics Libsnark
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">C++ library for zkSNARK proofs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c8b8562f36ef8ac91d61add84b644d5a.html">libsnark</a></li><li class="navelem"><a class="el" href="dir_a474a8b42b0cfdbc437e10452c282896.html">gadgetlib2</a></li><li class="navelem"><a class="el" href="dir_73e39d26f1dcfc63a8814c47512312e7.html">examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">tutorial.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tutorial_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;depends/gtest/googletest/include/gtest/gtest.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="gadgetlib2_2examples_2simple__example_8hpp.html">libsnark/gadgetlib2/examples/simple_example.hpp</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="gadgetlib2_2gadget_8hpp.html">libsnark/gadgetlib2/gadget.hpp</a>&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="r1cs__examples_8hpp.html">libsnark/relations/constraint_satisfaction_problems/r1cs/examples/r1cs_examples.hpp</a>&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="run__r1cs__ppzksnark_8hpp.html">libsnark/zk_proof_systems/ppzksnark/r1cs_ppzksnark/examples/run_r1cs_ppzksnark.hpp</a>&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="namespacegadgetExamples.html">   20</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacegadgetExamples.html">gadgetExamples</a></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacegadgetlib2.html">gadgetlib2</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">    This test gives the first example of a construction of a constraint system.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">   We use the terms &#39;Constraint System&#39; and &#39;Circuit&#39; interchangeably rather</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">   loosely. It is easy to visualize a circuit with inputs and outputs. Each gate</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">   imposes some logic on the inputs and output wires. For instance, AND(inp1,</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   inp2) will impose the &#39;constraint&#39; (inp1 &amp; inp2 = out) Thus, we can also</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">   think of this circuit as a system of constraints. Each gate is a mathematical</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">    constraint and each wire is a variable. In the AND example over a boolean</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">   field {0,1} we would write the constraint as (inp1 * inp2 == out). This</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">   constraint is &#39;satisfied&#39; relative to an assignment if we assign values to</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">   {inp1, inp2, out} such that the constraint evaluates to TRUE. All following</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">   examples will be either field agnostic or of a specific form of prime fields:</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">    (1) Field agnostic case: In these examples we create high level circuits by</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">   using lower level circuits. This way we can ignore the specifics of a field</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">   and assume the lower level takes care of this. If we must explicitly write</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">   constraints in these circuits, they will always be very basic constraints</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">   which are defined over every field (e.g. x + y = 0). (2) All field specific</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">   examples in this library are for a prime characteristic field with the</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">        special form of &#39;quadratic rank 1 polynomials&#39;, or R1P. This is the only</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">   form used with the current implementation of SNARKs. The form for these</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">   constraints is (Linear Combination) * (Linear Combination) == (Linear</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">   Combination). The library has been designed to allow future addition of other</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">   characteristics/forms in the future by implementing only low level circuits</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">   for these forms.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="namespacegadgetExamples.html#acecc02e67e5373048121210b42fd00fd">   50</a></span>&#160;<a class="code" href="namespacegadgetExamples.html#acecc02e67e5373048121210b42fd00fd">TEST</a>(Examples, ProtoboardUsage)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// Initialize prime field parameters. This is always needed for R1P.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a57ca2185847241c58a1856bb6173ab58">initPublicParamsFromDefaultPp</a>();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// The protoboard is the &#39;memory manager&#39; which holds all constraints (when</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// creating the verifying circuit) and variable assignments (when creating</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// the proof witness). We specify the type as R1P, this can be augmented in</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// the future to allow for BOOLEAN or GF2_EXTENSION fields in the future.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb = <a class="code" href="classgadgetlib2_1_1Protoboard.html#a86c4a0c196b0fa162da44bde500d8540">Protoboard::create</a>(<a class="code" href="namespacegadgetlib2.html#a8b74f15db66d52b2cf9977dbcde12a75a5340bb8369312e57b1d556c05fc6abdc">R1P</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// We now create 3 input variables and one output</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> input(3, <span class="stringliteral">&quot;input&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classgadgetlib2_1_1Variable.html">Variable</a> output(<span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// We can now add some constraints. The string is for debugging purposes and</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// can be a textual description of the constraint</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    pb-&gt;addRank1Constraint(</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        input[0],</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        5 + input[2],</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        output,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="stringliteral">&quot;Constraint 1: input[0] * (5 + input[2]) == output&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// The second form addUnaryConstraint(LinearCombination) means</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// (LinearCombination == 0).</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    pb-&gt;addUnaryConstraint(</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        input[1] - output, <span class="stringliteral">&quot;Constraint 2: input[1] - output == 0&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// Notice this could also have been written:</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// pb-&gt;addRank1Constraint(1, input[1] - input[2], 0, &quot;&quot;);</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// For fields with more general forms, once implemented, we could use</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// addGeneralConstraint(Polynomial1, Polynomial2, string) which translates</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// to the constraint (Polynomial1 == Polynomial2).  Example:</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// pb-&gt;addGeneralConstraint(input[0] * (3 + input[1]) * input[2], output +</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// 5,</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">//                          &quot;input[0] * (3 + input[1]) * input[2] == output</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">//                          + 5&quot;);</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// Now we can assign values to the variables and see if the constraints are</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// satisfied. Later, when we will run a SNARK (or any other proof system),</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// the constraints will be used by the verifier, and the assigned values</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// will be used by the prover. Notice the protoboard stores the assignment</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// values.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    pb-&gt;val(input[0]) = pb-&gt;val(input[1]) = pb-&gt;val(input[2]) =</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        pb-&gt;val(output) = 42;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    EXPECT_FALSE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// The constraint system is not satisfied. Now let&#39;s try values which</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// satisfy the two equations above:</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    pb-&gt;val(input[0]) = 1;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    pb-&gt;val(input[1]) = pb-&gt;val(output) = 42; <span class="comment">// input[1] - output == 0</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    pb-&gt;val(input[2]) = 37;                   <span class="comment">// 1 * (5 + 37) == 42</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    EXPECT_TRUE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    In the above example we explicitly wrote all constraints and assignments.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    In this example we will construct a very simple gadget, one that implements</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">   a NAND gate. This gadget is field-agnostic as it only uses lower level</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">   gadgets and the field elements &#39;0&#39; &amp; &#39;1&#39;.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">    Gadgets are the framework which allow us to delegate construction of</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">   sophisticated circuitry to lower levels. Each gadget can construct a</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">   constraint system or a witness or both, by defining constraints and</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">   assignments as well as by utilizing sub-gadgets.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1NAND__Gadget.html">  113</a></span>&#160;<span class="keyword">class </span><a class="code" href="classgadgetExamples_1_1NAND__Gadget.html">NAND_Gadget</a> : <span class="keyword">public</span> <a class="code" href="classgadgetlib2_1_1Gadget.html">Gadget</a></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// This is a convention we use to always create gadgets as if from a factory</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// class. This will be needed later for gadgets which have different</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// implementations in different fields.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">static</span> <a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> create(</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">FlagVariableArray</a> &amp;inputs,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">FlagVariable</a> &amp;output);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// generateConstraints() is the method which creates all constraints on the</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// protoboard</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">void</span> generateConstraints();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// generateWitness() is the method which generates the witness by assigning</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// a valid value to each wire in the circuit (variable) and putting this on</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// the protoboard</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">void</span> generateWitness();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// constructor is private in order to stick to the convention that gadgets</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// are created using a create() method. This may not make sense now, but</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// when dealing with non-field agnostic gadgets it is very convenient to</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// have a factory class with this convention. Notice the protoboard. This</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// can be thought of as a &#39;memory manager&#39; which holds the circuit as the</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// constraints are being built, and the &#39;wire values&#39; as the witness is</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// being built</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classgadgetExamples_1_1NAND__Gadget.html">NAND_Gadget</a>(</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">FlagVariableArray</a> &amp;inputs,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">FlagVariable</a> &amp;output);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// init() does any non trivial work which we don&#39;t want in the constructor.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// This is where we will &#39;wire&#39; the sub-gadgets into the circuit. Each</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// sub-gadget can be thought of as a circuit gate with some specific</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// functionality.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">void</span> init();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// we want every gadget to be explicitly constructed</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="infrastructure_8hpp.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(<a class="code" href="classgadgetExamples_1_1NAND__Gadget.html">NAND_Gadget</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// This is an internal gadget. Once a gadget is created it can be used as a</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// black box gate. We will initialize this pointer to be an AND_Gadget in</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// the init() method.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> andGadget_;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// These are internal variables used by the class. They will always include</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// the variables from the constructor, but can include many more as well.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Notice that almost always the variables can be declared &#39;const&#39;, as these</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// are local copies of formal variables, and do not change over the span of</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// the class&#39; lifetime.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> inputs_;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">FlagVariable</a> output_;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">FlagVariable</a> andResult_;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;};</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// IMPLEMENTATION</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">// Most constructors are trivial and only initialize and assert values.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;NAND_Gadget::NAND_Gadget(</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">FlagVariableArray</a> &amp;inputs,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">FlagVariable</a> &amp;output)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    : <a class="code" href="classgadgetlib2_1_1Gadget.html">Gadget</a>(pb), inputs_(inputs), output_(output), andResult_(<span class="stringliteral">&quot;andResult&quot;</span>)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">void</span> NAND_Gadget::init()</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// we &#39;wire&#39; the AND gate.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    andGadget_ = <a class="code" href="classgadgetlib2_1_1AND__Gadget.html#a76aeaf47306e82806ea5b8ce424e0285">AND_Gadget::create</a>(<a class="code" href="classgadgetlib2_1_1Gadget.html#a31a6e73bc3febb8358877f1026f4a262">pb_</a>, inputs_, andResult_);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">// The create() method will usually look like this, for field-agnostic gadgets:</span></div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1NAND__Gadget.html#ad34ac1d69dc0cc00959ca90aa7c5f05e">  182</a></span>&#160;<a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> <a class="code" href="classgadgetExamples_1_1NAND__Gadget.html#ad34ac1d69dc0cc00959ca90aa7c5f05e">NAND_Gadget::create</a>(</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">FlagVariableArray</a> &amp;inputs,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">FlagVariable</a> &amp;output)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> pGadget(<span class="keyword">new</span> <a class="code" href="classgadgetExamples_1_1NAND__Gadget.html">NAND_Gadget</a>(pb, inputs, output));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    pGadget-&gt;init();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">return</span> pGadget;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1NAND__Gadget.html#a531168920f9d4cd9d1e13e21033293d0">  192</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1NAND__Gadget.html#a531168920f9d4cd9d1e13e21033293d0">NAND_Gadget::generateConstraints</a>()</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// we will invoke the AND gate constraint generator</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    andGadget_-&gt;generateConstraints();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// and add our out negation constraint in order to make this a NAND gate</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classgadgetlib2_1_1Gadget.html#a32d5fc8c2bda19f546687dd6aab08d47">addRank1Constraint</a>(</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        1, 1 - andResult_, output_, <span class="stringliteral">&quot;1 * (1 - andResult) = output&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// Another way to write the same constraint is:</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// addUnaryConstraint(1 - andResult_ - output_, &quot;1 - andResult == output&quot;);</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// At first look, it would seem that this is enough. However, the AND_Gadget</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// expects all of its inputs to be boolean, a dishonest prover could put</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// non-boolean inputs, so we must check this here. Notice &#39;FlagVariable&#39;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// means a variable which we intend to hold only &#39;0&#39; or &#39;1&#39;, but this is</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// just a convention (it is a typedef for Variable) and we must enforce it.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// Look into the internals of the R1P implementation of AND_Gadget and see</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// that {2, 1, 0} as inputs with {1} as output would satisfy all</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// constraints, even though this is clearly not our intent!</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;input : inputs_) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="classgadgetlib2_1_1Gadget.html#a653dc87525348e3315927a5b5882b3e5">enforceBooleanity</a>(input); <span class="comment">// This adds a constraint of the form: input *</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                  <span class="comment">// (1 - input) == 0</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1NAND__Gadget.html#a0c95e057b0dc2a28797806655c6709cf">  216</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1NAND__Gadget.html#a0c95e057b0dc2a28797806655c6709cf">NAND_Gadget::generateWitness</a>()</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// First we can assert that all input values are indeed boolean. The purpose</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// of this assertion is simply to print a clear error message, it is not</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// security critical. Notice the method val() which returns a reference to</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// the current assignment for a variable</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;input : inputs_) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="infrastructure_8hpp.html#a39b88a070e951976f7aa294ea8d86198">GADGETLIB_ASSERT</a>(</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">val</a>(input) == 0 || <a class="code" href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">val</a>(input) == 1, <span class="stringliteral">&quot;NAND input is not boolean&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// we will invoke the AND gate witness generator, this will set andResult_</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// correctly</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    andGadget_-&gt;generateWitness();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// and now we set the value of output_</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">val</a>(output_) = 1 - <a class="code" href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">val</a>(andResult_);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// notice the use of &#39;val()&#39; to tell the protoboard to assign this new value</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// to the variable &#39;output_&#39;. The variable itself is only a formal variable</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// and never changes.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">// And now for a test which will exemplify the usage:</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="namespacegadgetExamples.html#acad6f15f0cfa40297f4f6c9fb77dd290">  237</a></span>&#160;<a class="code" href="namespacegadgetExamples.html#acecc02e67e5373048121210b42fd00fd">TEST</a>(Examples, <a class="code" href="classgadgetExamples_1_1NAND__Gadget.html">NAND_Gadget</a>)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// initialize the field</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a57ca2185847241c58a1856bb6173ab58">initPublicParamsFromDefaultPp</a>();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// create a protoboard for a system of rank 1 constraints over a prime</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// field.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb = <a class="code" href="classgadgetlib2_1_1Protoboard.html#a86c4a0c196b0fa162da44bde500d8540">Protoboard::create</a>(<a class="code" href="namespacegadgetlib2.html#a8b74f15db66d52b2cf9977dbcde12a75a5340bb8369312e57b1d556c05fc6abdc">R1P</a>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// create 5 variables inputs[0]...inputs[4]. The string &quot;inputs&quot; is used for</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// debug messages</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classgadgetlib2_1_1VariableArray.html">FlagVariableArray</a> inputs(5, <span class="stringliteral">&quot;inputs&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="classgadgetlib2_1_1Variable.html">FlagVariable</a> output(<span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> nandGadget = <a class="code" href="classgadgetExamples_1_1NAND__Gadget.html#ad34ac1d69dc0cc00959ca90aa7c5f05e">NAND_Gadget::create</a>(pb, inputs, output);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// now we can generate a constraint system (or circuit)</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    nandGadget-&gt;generateConstraints();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// if we try to evaluate the circuit now, an exception will be thrown,</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// because we will be attempting to evaluate unassigned variables.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    EXPECT_ANY_THROW(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// so let&#39;s assign the input variables for NAND and try again after creating</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// the witness</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;input : inputs) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        pb-&gt;val(input) = 1;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    nandGadget-&gt;generateWitness();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    EXPECT_TRUE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    EXPECT_TRUE(pb-&gt;val(output) == 0);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// now let&#39;s try to ruin something and see what happens</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    pb-&gt;val(inputs[2]) = 0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    EXPECT_FALSE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// now let&#39;s try to cheat. If we hadn&#39;t enforced booleanity, this would have</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// worked!</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    pb-&gt;val(inputs[1]) = 2;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    EXPECT_FALSE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// now let&#39;s reset inputs[1] to a valid value</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    pb-&gt;val(inputs[1]) = 1;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// before, we set both the inputs and the output. Notice the output is still</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// set to &#39;0&#39;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    EXPECT_TRUE(pb-&gt;val(output) == 0);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// Now we will let the gadget compute the result using generateWitness() and</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// see what happens</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    nandGadget-&gt;generateWitness();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    EXPECT_TRUE(pb-&gt;val(output) == 1);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    EXPECT_TRUE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">    Another example showing the use of DualVariable. A DualVariable is a</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">   variable which holds both a bitwise representation of a word and a packed</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">   representation (e.g. both the packed value {42} and the unpacked value</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">   {1,0,1,0,1,0}). If the word is short enough (for example any integer smaller</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">   than the prime characteristic) then the packed representation will be stored</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">   in 1 field element. &#39;word&#39; in this context means a set of bits, it is a</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    convention which means we expect some semantic ability to decompose the</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">   packed value into its bits. The use of DualVariables is for efficiency</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">   reasons. More on this at the end of this example. In this example we will</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">   construct a gadget which receives as input a packed integer value called</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">   &#39;hash&#39;, and a &#39;difficulty&#39; level in bits, and constructs a circuit validating</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">   that the first &#39;difficulty&#39; bits of &#39;hash&#39; are &#39;0&#39;. For simplicity we will</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">   assume &#39;hash&#39; is always 64 bits long.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html">  297</a></span>&#160;<span class="keyword">class </span><a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html">HashDifficultyEnforcer_Gadget</a> : <span class="keyword">public</span> <a class="code" href="classgadgetlib2_1_1Gadget.html">Gadget</a></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">static</span> <a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a1cf0775a81a5346406e9c81695b46b7a">create</a>(</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1MultiPackedWord.html">MultiPackedWord</a> &amp;hashValue,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> difficultyBits);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a2c3ff588aecfb8add7e6eaea21601b53">generateConstraints</a>();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a044ecc8a4538cebebacebf7156922255">generateWitness</a>();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> hashSizeInBits_;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> difficultyBits_;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="classgadgetlib2_1_1DualWord.html">DualWord</a> hashValue_;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// This GadgetPtr will be a gadget to unpack hashValue_ from packed</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// representation to bit representation. Recall &#39;DualWord&#39; holds both</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// values, but only the packed version will be received as input to the</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// constructor.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> hashValueUnpacker_;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html">HashDifficultyEnforcer_Gadget</a>(</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1MultiPackedWord.html">MultiPackedWord</a> &amp;hashValue,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> difficultyBits);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">void</span> init();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    DISALLOW_COPY_AND_ASSIGN(<a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html">HashDifficultyEnforcer_Gadget</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;};</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">// IMPLEMENTATION</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;HashDifficultyEnforcer_Gadget::HashDifficultyEnforcer_Gadget(</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1MultiPackedWord.html">MultiPackedWord</a> &amp;hashValue,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> difficultyBits)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    : <a class="code" href="classgadgetlib2_1_1Gadget.html">Gadget</a>(pb)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    , hashSizeInBits_(64)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    , difficultyBits_(difficultyBits)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    , hashValue_(hashValue, <a class="code" href="classgadgetlib2_1_1UnpackedWord.html">UnpackedWord</a>(64, <span class="stringliteral">&quot;hashValue_u&quot;</span>))</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordtype">void</span> HashDifficultyEnforcer_Gadget::init()</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;{</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// because we are using a prime field with large characteristic, we can</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// assume a 64 bit value fits in the first element of a multipacked</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// variable.</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="infrastructure_8hpp.html#a39b88a070e951976f7aa294ea8d86198">GADGETLIB_ASSERT</a>(</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        hashValue_.<a class="code" href="classgadgetlib2_1_1DualWord.html#a36382d89401071085ef9a9a16a980c76">multipacked</a>().size() == 1,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="stringliteral">&quot;multipacked word size too large&quot;</span>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// A DualWord_Gadget&#39;s constraints assert that the unpacked and packed</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// values represent the same integer element. The generateWitness() method</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// has two modes, one for packing (taking the bit representation as input)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// and one for unpacking (creating the bit representation from the packed</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// representation)</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    hashValueUnpacker_ =</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="classgadgetlib2_1_1DualWord__Gadget.html#a26e94e59217cbe2016af3f51e460fdbd">DualWord_Gadget::create</a>(<a class="code" href="classgadgetlib2_1_1Gadget.html#a31a6e73bc3febb8358877f1026f4a262">pb_</a>, hashValue_, PackingMode::UNPACK);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a1cf0775a81a5346406e9c81695b46b7a">  354</a></span>&#160;<a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a1cf0775a81a5346406e9c81695b46b7a">HashDifficultyEnforcer_Gadget::create</a>(</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1MultiPackedWord.html">MultiPackedWord</a> &amp;hashValue,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> difficultyBits)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;{</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">GadgetPtr</a> pGadget(</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">new</span> <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html">HashDifficultyEnforcer_Gadget</a>(pb, hashValue, difficultyBits));</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    pGadget-&gt;init();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">return</span> pGadget;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a2c3ff588aecfb8add7e6eaea21601b53">  365</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a2c3ff588aecfb8add7e6eaea21601b53">HashDifficultyEnforcer_Gadget::generateConstraints</a>()</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// enforce that both representations are equal</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    hashValueUnpacker_-&gt;generateConstraints();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// add constraints asserting that the first &#39;difficultyBits&#39; bits of</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// &#39;hashValue&#39; equal 0. Note endianness, unpacked()[0] is LSB and</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// unpacked()[63] is MSB</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; difficultyBits_; ++i) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="classgadgetlib2_1_1Gadget.html#a8f1d59422e7934b476251187ea79d905">addUnaryConstraint</a>(</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            hashValue_.<a class="code" href="classgadgetlib2_1_1DualWord.html#a8e3c624d7be33acc2c67a829e33b2f48">unpacked</a>()[63 - i],</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <a class="code" href="namespacegadgetlib2.html#a48e63c000711c82fe88e6085259a6dcd">GADGETLIB2_FMT</a>(<span class="stringliteral">&quot;hashValue[%u] == 0&quot;</span>, 63 - i));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a044ecc8a4538cebebacebf7156922255">  379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a044ecc8a4538cebebacebf7156922255">HashDifficultyEnforcer_Gadget::generateWitness</a>()</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// Take the packed representation and unpack to bits.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    hashValueUnpacker_-&gt;generateWitness();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// In a real setting we would add an assertion that the value will indeed</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// satisfy the difficulty constraint, and notify the user with an error</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// otherwise. As this is a tutorial, we&#39;ll let invalid values pass through</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// so that we can see how isSatisfied() returns false.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">// Remember we pointed out that DualVariables are used for efficiency reasons.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">// Now is the time to elaborate on this. As you&#39;ve seen, we needed a bit</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">// representation in order to check the first bits of hashValue. But hashValue</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">// may be used in many other places, for instance we may want to check equality</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">// with another value. Checking equality on a packed representation will &#39;cost&#39;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">// us 1 constraint, while checking equality on the unpacked value will &#39;cost&#39; us</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">// 64 constraints. This translates heavily into proof construction time and</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">// memory in the ppzkSNARK proof system.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="namespacegadgetExamples.html#aea534d482408f95bd307f6afa9dc72ce">  398</a></span>&#160;<a class="code" href="namespacegadgetExamples.html#acecc02e67e5373048121210b42fd00fd">TEST</a>(Examples, <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html">HashDifficultyEnforcer_Gadget</a>)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;{</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a57ca2185847241c58a1856bb6173ab58">initPublicParamsFromDefaultPp</a>();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keyword">auto</span> pb = <a class="code" href="classgadgetlib2_1_1Protoboard.html#a86c4a0c196b0fa162da44bde500d8540">Protoboard::create</a>(<a class="code" href="namespacegadgetlib2.html#a8b74f15db66d52b2cf9977dbcde12a75a5340bb8369312e57b1d556c05fc6abdc">R1P</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1MultiPackedWord.html">MultiPackedWord</a> hashValue(64, <a class="code" href="namespacegadgetlib2.html#a8b74f15db66d52b2cf9977dbcde12a75a5340bb8369312e57b1d556c05fc6abdc">R1P</a>, <span class="stringliteral">&quot;hashValue&quot;</span>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> difficulty = 10;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keyword">auto</span> difficultyEnforcer =</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <a class="code" href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a1cf0775a81a5346406e9c81695b46b7a">HashDifficultyEnforcer_Gadget::create</a>(pb, hashValue, difficulty);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    difficultyEnforcer-&gt;generateConstraints();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// constraints are created but no assignment yet. Will throw error on</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">// evaluation</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    EXPECT_ANY_THROW(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    pb-&gt;val(hashValue[0]) = 42;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    difficultyEnforcer-&gt;generateWitness();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// First 10 bits of 42 (when represented as a 64 bit number) are &#39;0&#39; so this</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// should work</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    EXPECT_TRUE(pb-&gt;isSatisfied(PrintOptions::DBG_PRINT_IF_NOT_SATISFIED));</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    pb-&gt;val(hashValue[0]) = 1000000000000000000;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// This is a value &gt; 2^54 so we expect constraint system not to be</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// satisfied.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    difficultyEnforcer</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        -&gt;generateWitness(); <span class="comment">// This would have failed had we put an assertion</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    EXPECT_FALSE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">    In this example we will construct a gadget which builds a circuit for proof</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">   (witness) and validation (constraints) that a bitcoin transaction&#39;s sum of</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">   inputs equals the sum of outputs + miners fee. Construction of the proof will</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">   include finding the miners&#39; fee. This fee can be thought of as an output of</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">   the circuit.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">    This is a field specific gadget, as we will use the &#39;+&#39; operator freely. The</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">   addition operation works as expected over integers while in prime</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">   characteristic fields but not so in extension fields. If you are not familiar</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">   with extension fields, don&#39;t worry about it. Simply be aware that + and *</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">   behave differently in different fields and don&#39;t necessarily give the integer</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">   values you would expect.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">    The library design supports multiple field constructs due to different</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">   applied use cases. Some cryptographic applications may need extension fields</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">   while others may need prime fields, but with constraints which are not</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">   rank-1, and yet others may need boolean circuits. The library was designed so</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">   that high level gadgets can be reused by implementing only the low level for</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">    a new field or constraint structure.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    Later we will supply a recipe for creation of such field specific gadgets</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">   with agnostic interfaces. We use a few conventions here in order to ease the</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">   process by using macros.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">// This is a macro which creates an interface class for all field specific</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">// derived gadgets Convention is: class {GadgetName}_GadgetBase</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<a class="code" href="namespacegadgetExamples.html#a22ca7514679147e03f6106eb83263e8d">CREATE_GADGET_BASE_CLASS</a>(VerifyTransactionAmounts_GadgetBase);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">// Notice the multiple inheritance. We must specify the interface as well as the</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">// field specific base gadget. This is what allows the factory class to decide</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">// at compile time which field specific class to instantiate for every</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">// protoboard. See design notes in &quot;gadget.hpp&quot; Convention is: class</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">// {FieldType}_{GadgetName}_Gadget</span></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html">  458</a></span>&#160;<span class="keyword">class </span><a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html">R1P_VerifyTransactionAmounts_Gadget</a></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    : <span class="keyword">public</span> VerifyTransactionAmounts_GadgetBase</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    , <span class="keyword">public</span> <a class="code" href="classgadgetlib2_1_1R1P__Gadget.html">R1P_Gadget</a></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;{</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a4a966f9dee845e79e0ec9af0b03038fb">generateConstraints</a>();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a00367bae55c4a0816c29b37cfec963a5">generateWitness</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// We give the factory class friend access in order to instantiate via</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// private constructor.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#ab1c87bbad0ea641a6132740c1295d8ca">  468</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#ab1c87bbad0ea641a6132740c1295d8ca">VerifyTransactionAmounts_Gadget</a>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html">R1P_VerifyTransactionAmounts_Gadget</a>(</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> &amp;txInputAmounts,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> &amp;txOutputAmounts,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">Variable</a> &amp;minersFee);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">void</span> init();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> txInputAmounts_;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> txOutputAmounts_;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">Variable</a> minersFee_;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="infrastructure_8hpp.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(<a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html">R1P_VerifyTransactionAmounts_Gadget</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;};</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">// create factory class using CREATE_GADGET_FACTORY_CLASS_XX macro (substitute</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">// XX with the number of arguments to the constructor, excluding the</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">// protoboard). Sometimes we want multiple constructors, see AND_Gadget for</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">// example. In this case we will have to manually write the factory class.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<a class="code" href="namespacegadgetExamples.html#aa9a1c6b20d744a23876812abbf9aac97">CREATE_GADGET_FACTORY_CLASS_3</a>(</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    VerifyTransactionAmounts_Gadget,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a>,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    txInputAmounts,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a>,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    txOutputAmounts,</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="classgadgetlib2_1_1Variable.html">Variable</a>,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    minersFee);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">// IMPLEMENTATION</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">// Destructor for the Base class</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;VerifyTransactionAmounts_GadgetBase::~VerifyTransactionAmounts_GadgetBase() {}</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a4a966f9dee845e79e0ec9af0b03038fb">  503</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a4a966f9dee845e79e0ec9af0b03038fb">R1P_VerifyTransactionAmounts_Gadget::generateConstraints</a>()</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;{</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="classgadgetlib2_1_1Gadget.html#a8f1d59422e7934b476251187ea79d905">addUnaryConstraint</a>(</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="namespacegadgetlib2.html#a8dadb7e8f6efb146bd1818f4a8b75142">sum</a>(txInputAmounts_) - <a class="code" href="namespacegadgetlib2.html#a8dadb7e8f6efb146bd1818f4a8b75142">sum</a>(txOutputAmounts_) - minersFee_,</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="stringliteral">&quot;sum(txInputAmounts) == sum(txOutputAmounts) + minersFee&quot;</span>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// It would seem this is enough, but an adversary could cause an overflow of</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// one side of the equation over the field modulus. In fact, for every</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// input/output sum we will always find a miners&#39; fee which will satisfy</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// this constraint! It is left as an exercise for the reader to implement</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// additional constraints (and witness) to check that each of the amounts</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// (inputs, outputs, fee) are between 0 and 21,000,000 * 1E8 satoshis.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// Combine this with a maximum amount of inputs/outputs to disallow field</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// overflow.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// Hint: use Comparison_Gadget to create a gadget which compares a</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// variable&#39;s assigned value to a constant. Use a vector of these new</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// gadgets to check each amount. Don&#39;t forget to: (1) Wire these gadgets in</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// init() (2) Invoke the gadgets&#39; constraints in generateConstraints() (3)</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// Invoke the gadgets&#39; witnesses in generateWitness()</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a00367bae55c4a0816c29b37cfec963a5">  524</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a00367bae55c4a0816c29b37cfec963a5">R1P_VerifyTransactionAmounts_Gadget::generateWitness</a>()</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="classgadgetlib2_1_1FElem.html">FElem</a> sumInputs = 0;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="classgadgetlib2_1_1FElem.html">FElem</a> sumOutputs = 0;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;inputAmount : txInputAmounts_) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        sumInputs += <a class="code" href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">val</a>(inputAmount);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;outputAmount : txOutputAmounts_) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        sumOutputs += <a class="code" href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">val</a>(outputAmount);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">val</a>(minersFee_) = sumInputs - sumOutputs;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;R1P_VerifyTransactionAmounts_Gadget::R1P_VerifyTransactionAmounts_Gadget(</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">ProtoboardPtr</a> pb,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> &amp;txInputAmounts,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> &amp;txOutputAmounts,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">Variable</a> &amp;minersFee)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// Notice we must initialize 3 base classes (diamond inheritance):</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    : <a class="code" href="classgadgetlib2_1_1Gadget.html">Gadget</a>(pb)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    , VerifyTransactionAmounts_GadgetBase(pb)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    , <a class="code" href="classgadgetlib2_1_1R1P__Gadget.html">R1P_Gadget</a>(pb)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    , txInputAmounts_(txInputAmounts)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    , txOutputAmounts_(txOutputAmounts)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    , minersFee_(minersFee)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;{</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordtype">void</span> R1P_VerifyTransactionAmounts_Gadget::init() {}</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">    As promised, recipe for creating field specific gadgets with agnostic</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">   interfaces:</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">    (1) Create the Base class using macro:</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">        CREATE_GADGET_BASE_CLASS({GadgetName}_GadgetBase);</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">    (2) Create the destructor for the base class:</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">        {GadgetName_Gadget}Base::~{GadgetName}_GadgetBase() {}</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">    (3) Create any field specific gadgets with multiple inheritance:</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">        class {FieldType}_{GadgetName}_Gadget : public {GadgetName}_GadgetBase,</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">                                                public {FieldType_Gadget}</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">        Notice all arguments to the constructors must be const&amp; in order to use</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">   the factory class macro. Constructor arguments must be the same for all field</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">   specific implementations. (4) Give the factory class {GadgetName}_Gadget</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">   public friend access to the field specific classes. (5) Create the factory</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">   class using the macro: CREATE_GADGET_FACTORY_CLASS_XX({GadgetName}_Gadget,</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">   type1, input1, type2, input2, ... , typeXX, inputXX);</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="namespacegadgetExamples.html#abe30386e47d56572d76a7d3e173a6856">  573</a></span>&#160;<a class="code" href="namespacegadgetExamples.html#acecc02e67e5373048121210b42fd00fd">TEST</a>(Examples, <a class="code" href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html">R1P_VerifyTransactionAmounts_Gadget</a>)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a57ca2185847241c58a1856bb6173ab58">initPublicParamsFromDefaultPp</a>();</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keyword">auto</span> pb = <a class="code" href="classgadgetlib2_1_1Protoboard.html#a86c4a0c196b0fa162da44bde500d8540">Protoboard::create</a>(<a class="code" href="namespacegadgetlib2.html#a8b74f15db66d52b2cf9977dbcde12a75a5340bb8369312e57b1d556c05fc6abdc">R1P</a>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> inputAmounts(2, <span class="stringliteral">&quot;inputAmounts&quot;</span>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1VariableArray.html">VariableArray</a> outputAmounts(3, <span class="stringliteral">&quot;outputAmounts&quot;</span>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keyword">const</span> <a class="code" href="classgadgetlib2_1_1Variable.html">Variable</a> minersFee(<span class="stringliteral">&quot;minersFee&quot;</span>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keyword">auto</span> verifyTx = VerifyTransactionAmounts_Gadget::create(</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        pb, inputAmounts, outputAmounts, minersFee);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    verifyTx-&gt;generateConstraints();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    pb-&gt;val(inputAmounts[0]) = pb-&gt;val(inputAmounts[1]) = 2;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    pb-&gt;val(outputAmounts[0]) = pb-&gt;val(outputAmounts[1]) =</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        pb-&gt;val(outputAmounts[2]) = 1;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    verifyTx-&gt;generateWitness();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    EXPECT_TRUE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    EXPECT_EQ(pb-&gt;val(minersFee), 1);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    pb-&gt;val(minersFee) = 3;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    EXPECT_FALSE(pb-&gt;isSatisfied());</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">    Below is an example of integrating gadgetlib2 constructed constraint systems</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">   with the ppzkSNARK.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="namespacegadgetExamples.html#a9b42243a7d524325533f77ca2f9d7a6b">  598</a></span>&#160;<a class="code" href="namespacegadgetExamples.html#acecc02e67e5373048121210b42fd00fd">TEST</a>(gadgetLib2, Integration)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="namespacegadgetlib2.html#a57ca2185847241c58a1856bb6173ab58">initPublicParamsFromDefaultPp</a>();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">// Create an example constraint system and translate to libsnark format</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keyword">const</span> <a class="code" href="structlibsnark_1_1r1cs__example.html">libsnark::r1cs_example&lt;libff::Fr&lt;libff::default_ec_pp&gt;</a>&gt; example =</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="namespacelibsnark.html#ade67271c111cdcd96666b4d3b58a8bd3">libsnark::gen_r1cs_example_from_gadgetlib2_protoboard</a>(100);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> test_serialization = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">// Run ppzksnark. Jump into function for breakdown</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> bit = libsnark::run_r1cs_ppzksnark&lt;libff::default_ec_pp&gt;(</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        example, test_serialization);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    EXPECT_TRUE(bit);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;};</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;} <span class="comment">// namespace gadgetExamples</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="tutorial_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">  613</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="tutorial_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    ::testing::InitGoogleTest(&amp;argc, argv);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">return</span> RUN_ALL_TESTS();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacegadgetExamples_html_a22ca7514679147e03f6106eb83263e8d"><div class="ttname"><a href="namespacegadgetExamples.html#a22ca7514679147e03f6106eb83263e8d">gadgetExamples::CREATE_GADGET_BASE_CLASS</a></div><div class="ttdeci">CREATE_GADGET_BASE_CLASS(VerifyTransactionAmounts_GadgetBase)</div></div>
<div class="ttc" id="aclassgadgetlib2_1_1DualWord_html"><div class="ttname"><a href="classgadgetlib2_1_1DualWord.html">gadgetlib2::DualWord</a></div><div class="ttdoc">Holds both representations of a word, both multipacked and unpacked.</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00424">variable.hpp:424</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1R1P__Gadget_html"><div class="ttname"><a href="classgadgetlib2_1_1R1P__Gadget.html">gadgetlib2::R1P_Gadget</a></div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2gadget_8hpp_source.html#l00146">gadget.hpp:146</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1HashDifficultyEnforcer__Gadget_html_a044ecc8a4538cebebacebf7156922255"><div class="ttname"><a href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a044ecc8a4538cebebacebf7156922255">gadgetExamples::HashDifficultyEnforcer_Gadget::generateWitness</a></div><div class="ttdeci">void generateWitness()</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00379">tutorial.cpp:379</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1NAND__Gadget_html"><div class="ttname"><a href="classgadgetExamples_1_1NAND__Gadget.html">gadgetExamples::NAND_Gadget</a></div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00113">tutorial.cpp:113</a></div></div>
<div class="ttc" id="atutorial_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="tutorial_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00613">tutorial.cpp:613</a></div></div>
<div class="ttc" id="astructlibsnark_1_1r1cs__example_html"><div class="ttname"><a href="structlibsnark_1_1r1cs__example.html">libsnark::r1cs_example</a></div><div class="ttdef"><b>Definition:</b> <a href="r1cs__examples_8hpp_source.html#l00025">r1cs_examples.hpp:25</a></div></div>
<div class="ttc" id="anamespacegadgetlib2_html_a48e63c000711c82fe88e6085259a6dcd"><div class="ttname"><a href="namespacegadgetlib2.html#a48e63c000711c82fe88e6085259a6dcd">gadgetlib2::GADGETLIB2_FMT</a></div><div class="ttdeci">::std::string GADGETLIB2_FMT(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="infrastructure_8cpp_source.html#l00049">infrastructure.cpp:49</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1NAND__Gadget_html_ad34ac1d69dc0cc00959ca90aa7c5f05e"><div class="ttname"><a href="classgadgetExamples_1_1NAND__Gadget.html#ad34ac1d69dc0cc00959ca90aa7c5f05e">gadgetExamples::NAND_Gadget::create</a></div><div class="ttdeci">static GadgetPtr create(ProtoboardPtr pb, const FlagVariableArray &amp;inputs, const FlagVariable &amp;output)</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00182">tutorial.cpp:182</a></div></div>
<div class="ttc" id="anamespacegadgetExamples_html"><div class="ttname"><a href="namespacegadgetExamples.html">gadgetExamples</a></div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00020">tutorial.cpp:20</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1HashDifficultyEnforcer__Gadget_html"><div class="ttname"><a href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html">gadgetExamples::HashDifficultyEnforcer_Gadget</a></div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00297">tutorial.cpp:297</a></div></div>
<div class="ttc" id="agadgetlib2_2examples_2simple__example_8hpp_html"><div class="ttname"><a href="gadgetlib2_2examples_2simple__example_8hpp.html">simple_example.hpp</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Gadget_html_a32d5fc8c2bda19f546687dd6aab08d47"><div class="ttname"><a href="classgadgetlib2_1_1Gadget.html#a32d5fc8c2bda19f546687dd6aab08d47">gadgetlib2::Gadget::addRank1Constraint</a></div><div class="ttdeci">void addRank1Constraint(const LinearCombination &amp;a, const LinearCombination &amp;b, const LinearCombination &amp;c, const ::std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="gadget_8cpp_source.html#l00058">gadget.cpp:58</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1VariableArray_html"><div class="ttname"><a href="classgadgetlib2_1_1VariableArray.html">gadgetlib2::VariableArray</a></div><div class="ttdoc">VariableArray.</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00353">variable.hpp:353</a></div></div>
<div class="ttc" id="arun__r1cs__ppzksnark_8hpp_html"><div class="ttname"><a href="run__r1cs__ppzksnark_8hpp.html">run_r1cs_ppzksnark.hpp</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1MultiPackedWord_html"><div class="ttname"><a href="classgadgetlib2_1_1MultiPackedWord.html">gadgetlib2::MultiPackedWord</a></div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00404">variable.hpp:404</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Gadget_html_ae8f38d5df08d5d0a24af21da23fd45b0"><div class="ttname"><a href="classgadgetlib2_1_1Gadget.html#ae8f38d5df08d5d0a24af21da23fd45b0">gadgetlib2::Gadget::val</a></div><div class="ttdeci">FElem &amp; val(const Variable &amp;var)</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2gadget_8hpp_source.html#l00109">gadget.hpp:109</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Gadget_html"><div class="ttname"><a href="classgadgetlib2_1_1Gadget.html">gadgetlib2::Gadget</a></div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2gadget_8hpp_source.html#l00081">gadget.hpp:81</a></div></div>
<div class="ttc" id="ar1cs__examples_8hpp_html"><div class="ttname"><a href="r1cs__examples_8hpp.html">r1cs_examples.hpp</a></div></div>
<div class="ttc" id="agadgetlib2_2gadget_8hpp_html"><div class="ttname"><a href="gadgetlib2_2gadget_8hpp.html">gadget.hpp</a></div></div>
<div class="ttc" id="anamespacegadgetExamples_html_aa9a1c6b20d744a23876812abbf9aac97"><div class="ttname"><a href="namespacegadgetExamples.html#aa9a1c6b20d744a23876812abbf9aac97">gadgetExamples::CREATE_GADGET_FACTORY_CLASS_3</a></div><div class="ttdeci">CREATE_GADGET_FACTORY_CLASS_3(VerifyTransactionAmounts_Gadget, VariableArray, txInputAmounts, VariableArray, txOutputAmounts, Variable, minersFee)</div></div>
<div class="ttc" id="aclassgadgetlib2_1_1FElem_html"><div class="ttname"><a href="classgadgetlib2_1_1FElem.html">gadgetlib2::FElem</a></div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00101">variable.hpp:101</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1UnpackedWord_html"><div class="ttname"><a href="classgadgetlib2_1_1UnpackedWord.html">gadgetlib2::UnpackedWord</a></div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00389">variable.hpp:389</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1DualWord__Gadget_html_a26e94e59217cbe2016af3f51e460fdbd"><div class="ttname"><a href="classgadgetlib2_1_1DualWord__Gadget.html#a26e94e59217cbe2016af3f51e460fdbd">gadgetlib2::DualWord_Gadget::create</a></div><div class="ttdeci">static GadgetPtr create(ProtoboardPtr pb, const DualWord &amp;var, PackingMode packingMode)</div><div class="ttdef"><b>Definition:</b> <a href="gadget_8cpp_source.html#l00842">gadget.cpp:842</a></div></div>
<div class="ttc" id="anamespacegadgetlib2_html_aa29034e17906668f87f9c6943957aea5"><div class="ttname"><a href="namespacegadgetlib2.html#aa29034e17906668f87f9c6943957aea5">gadgetlib2::GadgetPtr</a></div><div class="ttdeci">::std::shared_ptr&lt; Gadget &gt; GadgetPtr</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2gadget_8hpp_source.html#l00119">gadget.hpp:119</a></div></div>
<div class="ttc" id="ainfrastructure_8hpp_html_af8df3547bfde53a5acb93e2607b0034a"><div class="ttname"><a href="infrastructure_8hpp.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a></div><div class="ttdeci">#define DISALLOW_COPY_AND_ASSIGN(TypeName)</div><div class="ttdef"><b>Definition:</b> <a href="infrastructure_8hpp_source.html#l00040">infrastructure.hpp:40</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Gadget_html_a653dc87525348e3315927a5b5882b3e5"><div class="ttname"><a href="classgadgetlib2_1_1Gadget.html#a653dc87525348e3315927a5b5882b3e5">gadgetlib2::Gadget::enforceBooleanity</a></div><div class="ttdeci">void enforceBooleanity(const Variable &amp;var)</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2gadget_8hpp_source.html#l00108">gadget.hpp:108</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1NAND__Gadget_html_a0c95e057b0dc2a28797806655c6709cf"><div class="ttname"><a href="classgadgetExamples_1_1NAND__Gadget.html#a0c95e057b0dc2a28797806655c6709cf">gadgetExamples::NAND_Gadget::generateWitness</a></div><div class="ttdeci">void generateWitness()</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00216">tutorial.cpp:216</a></div></div>
<div class="ttc" id="anamespacegadgetlib2_html_a57ca2185847241c58a1856bb6173ab58"><div class="ttname"><a href="namespacegadgetlib2.html#a57ca2185847241c58a1856bb6173ab58">gadgetlib2::initPublicParamsFromDefaultPp</a></div><div class="ttdeci">PublicParams initPublicParamsFromDefaultPp()</div><div class="ttdef"><b>Definition:</b> <a href="pp_8cpp_source.html#l00023">pp.cpp:23</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Protoboard_html_a86c4a0c196b0fa162da44bde500d8540"><div class="ttname"><a href="classgadgetlib2_1_1Protoboard.html#a86c4a0c196b0fa162da44bde500d8540">gadgetlib2::Protoboard::create</a></div><div class="ttdeci">static ProtoboardPtr create(const FieldType &amp;fieldType, ParamsCPtr pParams=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2protoboard_8hpp_source.html#l00054">protoboard.hpp:54</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Gadget_html_a8f1d59422e7934b476251187ea79d905"><div class="ttname"><a href="classgadgetlib2_1_1Gadget.html#a8f1d59422e7934b476251187ea79d905">gadgetlib2::Gadget::addUnaryConstraint</a></div><div class="ttdeci">void addUnaryConstraint(const LinearCombination &amp;a, const ::std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="gadget_8cpp_source.html#l00052">gadget.cpp:52</a></div></div>
<div class="ttc" id="anamespacegadgetExamples_html_acecc02e67e5373048121210b42fd00fd"><div class="ttname"><a href="namespacegadgetExamples.html#acecc02e67e5373048121210b42fd00fd">gadgetExamples::TEST</a></div><div class="ttdeci">TEST(Examples, ProtoboardUsage)</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00050">tutorial.cpp:50</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget_html_ab1c87bbad0ea641a6132740c1295d8ca"><div class="ttname"><a href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#ab1c87bbad0ea641a6132740c1295d8ca">gadgetExamples::R1P_VerifyTransactionAmounts_Gadget::VerifyTransactionAmounts_Gadget</a></div><div class="ttdeci">friend class VerifyTransactionAmounts_Gadget</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00468">tutorial.cpp:468</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1DualWord_html_a36382d89401071085ef9a9a16a980c76"><div class="ttname"><a href="classgadgetlib2_1_1DualWord.html#a36382d89401071085ef9a9a16a980c76">gadgetlib2::DualWord::multipacked</a></div><div class="ttdeci">MultiPackedWord multipacked() const</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00439">variable.hpp:439</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Variable_html"><div class="ttname"><a href="classgadgetlib2_1_1Variable.html">gadgetlib2::Variable</a></div><div class="ttdoc">A formal variable, field agnostic.</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00306">variable.hpp:306</a></div></div>
<div class="ttc" id="ainfrastructure_8hpp_html_a39b88a070e951976f7aa294ea8d86198"><div class="ttname"><a href="infrastructure_8hpp.html#a39b88a070e951976f7aa294ea8d86198">GADGETLIB_ASSERT</a></div><div class="ttdeci">#define GADGETLIB_ASSERT(predicate, msg)</div><div class="ttdef"><b>Definition:</b> <a href="infrastructure_8hpp_source.html#l00094">infrastructure.hpp:94</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1DualWord_html_a8e3c624d7be33acc2c67a829e33b2f48"><div class="ttname"><a href="classgadgetlib2_1_1DualWord.html#a8e3c624d7be33acc2c67a829e33b2f48">gadgetlib2::DualWord::unpacked</a></div><div class="ttdeci">UnpackedWord unpacked() const</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00440">variable.hpp:440</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1NAND__Gadget_html_a531168920f9d4cd9d1e13e21033293d0"><div class="ttname"><a href="classgadgetExamples_1_1NAND__Gadget.html#a531168920f9d4cd9d1e13e21033293d0">gadgetExamples::NAND_Gadget::generateConstraints</a></div><div class="ttdeci">void generateConstraints()</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00192">tutorial.cpp:192</a></div></div>
<div class="ttc" id="anamespacegadgetlib2_html_a8dadb7e8f6efb146bd1818f4a8b75142"><div class="ttname"><a href="namespacegadgetlib2.html#a8dadb7e8f6efb146bd1818f4a8b75142">gadgetlib2::sum</a></div><div class="ttdeci">LinearCombination sum(const VariableArray &amp;inputs)</div><div class="ttdef"><b>Definition:</b> <a href="variable_8cpp_source.html#l00616">variable.cpp:616</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget_html"><div class="ttname"><a href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html">gadgetExamples::R1P_VerifyTransactionAmounts_Gadget</a></div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00458">tutorial.cpp:458</a></div></div>
<div class="ttc" id="anamespacelibsnark_html_ade67271c111cdcd96666b4d3b58a8bd3"><div class="ttname"><a href="namespacelibsnark.html#ade67271c111cdcd96666b4d3b58a8bd3">libsnark::gen_r1cs_example_from_gadgetlib2_protoboard</a></div><div class="ttdeci">r1cs_example&lt; libff::Fr&lt; libff::default_ec_pp &gt; &gt; gen_r1cs_example_from_gadgetlib2_protoboard(const size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="simple__example_8cpp_source.html#l00019">simple_example.cpp:19</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1Gadget_html_a31a6e73bc3febb8358877f1026f4a262"><div class="ttname"><a href="classgadgetlib2_1_1Gadget.html#a31a6e73bc3febb8358877f1026f4a262">gadgetlib2::Gadget::pb_</a></div><div class="ttdeci">ProtoboardPtr pb_</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2gadget_8hpp_source.html#l00087">gadget.hpp:87</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1HashDifficultyEnforcer__Gadget_html_a1cf0775a81a5346406e9c81695b46b7a"><div class="ttname"><a href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a1cf0775a81a5346406e9c81695b46b7a">gadgetExamples::HashDifficultyEnforcer_Gadget::create</a></div><div class="ttdeci">static GadgetPtr create(ProtoboardPtr pb, const MultiPackedWord &amp;hashValue, const size_t difficultyBits)</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00354">tutorial.cpp:354</a></div></div>
<div class="ttc" id="anamespacegadgetlib2_html_a2d41428d0a716798ee8c7f92ab0082b2"><div class="ttname"><a href="namespacegadgetlib2.html#a2d41428d0a716798ee8c7f92ab0082b2">gadgetlib2::ProtoboardPtr</a></div><div class="ttdeci">::std::shared_ptr&lt; Protoboard &gt; ProtoboardPtr</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00042">variable.hpp:42</a></div></div>
<div class="ttc" id="aclassgadgetlib2_1_1AND__Gadget_html_a76aeaf47306e82806ea5b8ce424e0285"><div class="ttname"><a href="classgadgetlib2_1_1AND__Gadget.html#a76aeaf47306e82806ea5b8ce424e0285">gadgetlib2::AND_Gadget::create</a></div><div class="ttdeci">static GadgetPtr create(ProtoboardPtr pb, const VariableArray &amp;input, const Variable &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="gadget_8cpp_source.html#l00190">gadget.cpp:190</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget_html_a4a966f9dee845e79e0ec9af0b03038fb"><div class="ttname"><a href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a4a966f9dee845e79e0ec9af0b03038fb">gadgetExamples::R1P_VerifyTransactionAmounts_Gadget::generateConstraints</a></div><div class="ttdeci">void generateConstraints()</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00503">tutorial.cpp:503</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1HashDifficultyEnforcer__Gadget_html_a2c3ff588aecfb8add7e6eaea21601b53"><div class="ttname"><a href="classgadgetExamples_1_1HashDifficultyEnforcer__Gadget.html#a2c3ff588aecfb8add7e6eaea21601b53">gadgetExamples::HashDifficultyEnforcer_Gadget::generateConstraints</a></div><div class="ttdeci">void generateConstraints()</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00365">tutorial.cpp:365</a></div></div>
<div class="ttc" id="aclassgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget_html_a00367bae55c4a0816c29b37cfec963a5"><div class="ttname"><a href="classgadgetExamples_1_1R1P__VerifyTransactionAmounts__Gadget.html#a00367bae55c4a0816c29b37cfec963a5">gadgetExamples::R1P_VerifyTransactionAmounts_Gadget::generateWitness</a></div><div class="ttdeci">void generateWitness()</div><div class="ttdef"><b>Definition:</b> <a href="tutorial_8cpp_source.html#l00524">tutorial.cpp:524</a></div></div>
<div class="ttc" id="anamespacegadgetlib2_html"><div class="ttname"><a href="namespacegadgetlib2.html">gadgetlib2</a></div><div class="ttdef"><b>Definition:</b> <a href="adapters_8cpp_source.html#l00015">adapters.cpp:15</a></div></div>
<div class="ttc" id="anamespacegadgetlib2_html_a8b74f15db66d52b2cf9977dbcde12a75a5340bb8369312e57b1d556c05fc6abdc"><div class="ttname"><a href="namespacegadgetlib2.html#a8b74f15db66d52b2cf9977dbcde12a75a5340bb8369312e57b1d556c05fc6abdc">gadgetlib2::R1P</a></div><div class="ttdeci">@ R1P</div><div class="ttdef"><b>Definition:</b> <a href="gadgetlib2_2variable_8hpp_source.html#l00037">variable.hpp:37</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 25 2023 11:05:58 for Clearmatics Libsnark by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
